function stopAllImageSpritePlay(){$(".ImageSpritePlay").imageSpritePlay("stop")}!function(e){var t={image:null,frame_count:0,custom_range:null,next_range:null,loop:!1,autoplay:!1,delay:0,inverted:!1,velocity:500,fadeTransition:!1,randomized:!1,onComplete:null,onFrame:null,beforeStart:null,afterStop:null,onLoop:null,inlineStyle:!0},i=[],a={init:function(i){var a=e.extend(!0,{},t,i);return this.each(function(){e.fn.imageSpritePlay.process(e(this),a)})},first:function(){return this.each(function(){e.fn.imageSpritePlay.first(this)})},previous:function(){return this.each(function(){e.fn.imageSpritePlay.previous(this)})},play:function(){return this.each(function(){e.fn.imageSpritePlay.play(this)})},delay_play:function(t){return this.each(function(){e.fn.imageSpritePlay.delay_play(this,t)})},pause:function(){return this.each(function(){e.fn.imageSpritePlay.pause(this)})},resume:function(){return this.each(function(){e.fn.imageSpritePlay.resume(this)})},stop:function(){return this.each(function(){e.fn.imageSpritePlay.stop(this)})},justStop:function(){return this.each(function(){e.fn.imageSpritePlay.justStop(this)})},next:function(){return this.each(function(){e.fn.imageSpritePlay.next(this)})},goto:function(t){return this.each(function(){e.fn.imageSpritePlay.goto(this,t)})},restart:function(){return this.each(function(){e.fn.imageSpritePlay.restart(this)})},refresh:function(){return this.each(function(){e.fn.imageSpritePlay.refresh(this)})},last:function(){return this.each(function(){e.fn.imageSpritePlay.last(this)})},velocity:function(t){return this.each(function(){e.fn.imageSpritePlay.velocity(this,t)})},loop:function(t){return this.each(function(){e.fn.imageSpritePlay.loop(this,t)})},invert:function(){return this.each(function(){e.fn.imageSpritePlay.invert(this)})},delay:function(t){return this.each(function(){e.fn.imageSpritePlay.delay(this,t)})},attach:function(t,i){return this.each(function(){e.fn.imageSpritePlay.attach(this,t,i)})},setRange:function(t,i){return this.each(function(){e.fn.imageSpritePlay.setRange(this,t,i)})},nextRange:function(t,i,a){return this.each(function(){e.fn.imageSpritePlay.nextRange(this,t,i,a)})}};e.fn.imageSpritePlay=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.imageSpritePlay"):a.init.apply(this,arguments)},e.fn.imageSpritePlay.makeId=function(){for(var e="",t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",i=t.length,a=0;a<8;a++)e+=t.charAt(Math.floor(Math.random()*i));return e},e.fn.imageSpritePlay.createPngMarker=function(t,i){var a,n="tmp-canvas-"+t+"-"+i+"-"+e.fn.imageSpritePlay.makeId();e("body").append('<canvas style="opacity:0; display: none; position: absolute; top: -'+(2*i).toString()+"px; left: -"+(2*t).toString()+';" id="'+n+'" width="'+t+'" height="'+i+'"></canvas>');var r=document.getElementById(n),o=r.getContext("2d");return o.fillStyle="rgba(0, 0, 0, 0)",o.fillRect(0,0,t,i),a=r.toDataURL("image/png"),e("#"+n).remove(),a},e.fn.imageSpritePlay.loop=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;i[n].options.loop=a,e.fn.imageSpritePlay.refresh(n)},e.fn.imageSpritePlay.delay=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;i[n].options.delay=a,e.fn.imageSpritePlay.refresh(n)},e.fn.imageSpritePlay.invert=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;i[a].options.inverted=!i[a].options.inverted,null!==i[a].timer&&e.fn.imageSpritePlay.refresh(a)},e.fn.imageSpritePlay.velocity=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;i[n].options.velocity=a,null!==i[n].timer&&e.fn.imageSpritePlay.refresh(n)},e.fn.imageSpritePlay.delay_play=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==n&&setTimeout(function(){i[n].options.delay=0,e.fn.imageSpritePlay.play(n)},a)},e.fn.imageSpritePlay.play=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;if(void 0!==a){if(i[a].options.delay>0)return e.fn.imageSpritePlay.delay_play(a,i[a].options.delay);null!==i[a].timer&&clearInterval(i[a].timer),e.fn.imageSpritePlay._beforeStart(a),i[a].options.randomized?e.fn.imageSpritePlay.next(a):e.fn.imageSpritePlay.first(a),i[a].timer=setInterval(function(){e.fn.imageSpritePlay.next(a)},i[a].options.velocity)}},e.fn.imageSpritePlay.pause=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].timer&&clearInterval(i[a].timer)},e.fn.imageSpritePlay.stop=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].timer&&(clearInterval(i[a].timer),e.fn.imageSpritePlay._afterStop(a))},e.fn.imageSpritePlay.justStop=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].timer&&clearInterval(i[a].timer)},e.fn.imageSpritePlay.resume=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&(null!==i[a].timer&&clearInterval(i[a].timer),i[a].timer=setInterval(function(){e.fn.imageSpritePlay.next(a)},i[a].options.velocity))},e.fn.imageSpritePlay.refresh=function(t){e.fn.imageSpritePlay.pause(t),e.fn.imageSpritePlay.resume(t)},e.fn.imageSpritePlay.restart=function(t){e.fn.imageSpritePlay.stop(t),e.fn.imageSpritePlay.play(t)},e.fn.imageSpritePlay.goto=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==n&&(i[n].frame=a-1,e.fn.imageSpritePlay.updateFrame(n))},e.fn.imageSpritePlay.first=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&(i[a].frame=i[a].options.inverted?i[a].image.range[1]:i[a].image.range[0],e.fn.imageSpritePlay.updateFrame(a))},e.fn.imageSpritePlay.previous=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;if(void 0!==n){if(void 0===a&&i[n].options.inverted)return e.fn.imageSpritePlay.next(n,!0);if(!1===i[n].options.loop){if(!(i[n].frame>0))return void(null!==i[n].timer&&(e.fn.imageSpritePlay._onComplete(n),clearInterval(i[n].timer)));i[n].frame--}else i[n].frame>0?i[n].frame--:(e.fn.imageSpritePlay._onComplete(n),i[n].frame=i[n].options.frame_count-1);e.fn.imageSpritePlay.updateFrame(n)}},e.fn.imageSpritePlay.next=function(t,a){var n="object"==typeof t?e(t).attr("data-sprite-ids"):t;if(void 0!==n){if(i[n].options.randomized&&jQuery.error("TODO: Apply range"),void 0===a&&i[n].options.inverted)return e.fn.imageSpritePlay.previous(n,!0);if(!1===i[n].options.loop){if(i[n].frame>=i[n].image.range[1])return void(null!==i[n].timer&&(e.fn.imageSpritePlay._onComplete(n),e.fn.imageSpritePlay._afterStop(n),clearInterval(i[n].timer)));i[n].frame++}else i[n].frame<i[n].image.range[1]?i[n].frame++:(e.fn.imageSpritePlay._onComplete(n),null!==i[n].options.onLoop&&i[n].options.onLoop(i[n]),null!==i[n].options.next_range&&(i[n].image.range=i[n].options.next_range.range,void 0!==i[n].options.next_range.callback&&i[n].options.next_range.callback(),i[n].options.next_range=null),i[n].frame=i[n].image.range[0]);e.fn.imageSpritePlay.updateFrame(n)}},e.fn.imageSpritePlay._onComplete=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].options.onComplete&&i[a].options.onComplete.call(this,i[a])},e.fn.imageSpritePlay._beforeStart=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].options.beforeStart&&i[a].options.beforeStart.call(this,i[a])},e.fn.imageSpritePlay._afterStop=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&null!==i[a].options.afterStop&&i[a].options.afterStop.call(this,i[a])},e.fn.imageSpritePlay.last=function(t){var a="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==a&&(i[a].frame=i[a].options.inverted?0:i[a].options.frame_count-1,e.fn.imageSpritePlay.updateFrame(a))},e.fn.imageSpritePlay.ajustOnMarker=function(t){var a="#img-sprite-img-"+t;i[t].element.css({width:e(a).width(),height:e(a).height()})},e.fn.imageSpritePlay.updateFrame=function(t){var a=i[t].frame*i[t].image.frame_size*-1;i[t].options.fadeTransition?i[t].element.fadeOut("fast",function(){e.fn.imageSpritePlay._updateFrame(i[t],i[t].element,a,i[t].direction),i[t].element.fadeIn("fast")}):e.fn.imageSpritePlay._updateFrame(i[t],i[t].element,a,i[t].direction)},e.fn.imageSpritePlay._updateFrame=function(e,t,i,a){var n=100/(e.image.length-1)*e.frame;switch(a){case"h":t.css("background-position",n+"% 0px");break;case"v":t.css("background-position","0px "+n+"%")}null!==e.options.onFrame&&e.options.onFrame(e)},e.fn.imageSpritePlay.attach=function(t,a,n){var r="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==r&&(i[r].attached={marginTop:a,marginBottom:n},e.fn.imageSpritePlay._ajustRuler(i[r]),e(document).on("scroll.imageSpritePlay",function(t){e.fn.imageSpritePlay._ajustRuler(i[r])}),e(document).on("resize.imageSpritePlay",function(t){e.fn.imageSpritePlay._ajustRuler(i[r])}))},e.fn.imageSpritePlay.setRange=function(t,a,n){var r="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==r&&(i[r].frame=a,i[r].image.range=[a,n])},e.fn.imageSpritePlay.nextRange=function(t,a,n,r){var o="object"==typeof t?e(t).attr("data-sprite-ids"):t;void 0!==o&&(i[o].options.next_range={range:[a,n],callback:r})},e.fn.imageSpritePlay._ajustRuler=function(t){var i=t.attached.marginTop,a=t.attached.marginBottom,n=e(window).scrollTop()+e(window).height()/2,r=n-i,o=n+a,p=t.element.offset().top;if(p>r&&p<o){var l=100*(p-r)/(i+a),s=Math.round(l*t.options.frame_count/100);s<=0&&(s=1),t.element.imageSpritePlay("goto",s),e("#regua").css("backgroundColor","red")}else e("#regua").css("backgroundColor","blue")},e.fn.imageSpritePlay.process=function(t,a){for(var n=e.fn.imageSpritePlay.makeId();void 0!==i[n];)n=e.fn.imageSpritePlay.makeId();var r={};r.element=t,r.options=a,r.frame=0,r.direction="",r.image={},r.image.frame_size=0,r.image.length=0,r.image.range=null===a.custom_range?[0,0]:a.custom_range,r.image.loaded=!1,r.timer=null,r.attached=null,i[n]=r,t.attr("data-sprite-ids",n).addClass("ImageSpritePlay");var o=new Image;o.src=a.image,o.onload=function(){switch(i[n].image.loaded=!0,i[n].image.image=o,i[n].image.width=o.width,i[n].image.height=o.height,i[n].direction=i[n].image.width>i[n].image.height?"h":"v",i[n].direction){case"h":i[n].image.frame_size=i[n].image.width/i[n].options.frame_count,i[n].image.length=o.width/i[n].image.frame_size;break;case"v":i[n].image.frame_size=i[n].image.height/i[n].options.frame_count,i[n].image.length=o.height/i[n].image.frame_size}null===i[n].options.custom_range&&(i[n].image.range=[0,i[n].image.length-1]),i[n].frame=i[n].image.range[0];var t,a,r=i[n].frame*i[n].image.frame_size*-1;switch(i[n].direction){case"h":a=[i[n].image.frame_size,o.height],t=0===r?0:100/r,i[n].element.css("width","100%").css("height","100%").css("background-image","url("+i[n].options.image+")").css("background-size",(100*i[n].image.length).toString()+"%").css("background-repeat","no-repeat").css("background-position",t+"% 0px").css("position","absolute").css("top","0px");break;case"v":a=[o.width,o.objects[n].image.frame_size],i[n].element.css("width","100%").css("height","100%").css("background-image","url("+i[n].options.image+")").css("background-repeat","no-repeat").css("background-position","0px "+r+"px").css("position","absolute").css("top","0px")}var p=e.fn.imageSpritePlay.createPngMarker(a[0],a[1]),l="img-sprite-img-"+n;i[n].element.wrap('<div style="position: relative;" id="'+n+'-wrap"></div>'),i[n].element.parent().prepend('<img id="'+l+'" style="width: 100%;" src="'+p+'"/>'),i[n].options.autoplay&&e.fn.imageSpritePlay.play(n)}}}(jQuery);